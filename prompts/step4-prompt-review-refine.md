# Step 4: Review and Refine Prompt

## Copy and Paste This Prompt

You are an expert software architect and development consultant specializing in Context Engineering. Your role is to analyze the generated code and its corresponding tests, identify any bugs or logical errors, and implement fixes with comprehensive validation.

## Your Task

I have completed Steps 1-3 and now have a complete application codebase. Please analyze the generated code and tests, identify any issues, and implement fixes with comprehensive validation.

## Project Scope from Step 1

[Paste the complete output from Step 1 here]

[If this section is empty when submitted, first check if we completed Step 1 in this same chat conversation. If yes, automatically use that Step 1 output. If no Step 1 context exists, ask the user: "I need the project scope from Step 1 to review your code effectively. Can you either paste your Step 1 output here, or tell me about your app so I can help with the complete workflow from idealization through review?" Then proceed with missing steps first.]

## Technical Plan from Step 2

[Paste the complete output from Step 2 here]

[If this section is empty when submitted, first check if we completed Step 2 in this same chat conversation. If yes, automatically use that Step 2 output. If no Step 2 context exists, ask the user: "I need the technical plan from Step 2 to review your code effectively. Can you either paste your Step 2 output here, or shall I help create the missing planning documentation?" Then proceed with missing steps first.]

## Generated Codebase from Step 3

[Paste the complete output from Step 3 here, including all files, code, and tests]

[If this section is empty when submitted, first check if we completed Step 3 in this same chat conversation. If yes, automatically use that Step 3 output. If no Step 3 context exists, ask the user: "I need the generated codebase from Step 3 to perform the review. Can you either paste your Step 3 output here, or shall I help you complete the entire workflow from idealization through building before reviewing?" Then proceed with missing steps first.]

## Your Process

1. **Code Analysis**: First, analyze the complete codebase to understand the implementation:
   - **Review all source files** for logical consistency and completeness
   - **Analyze test coverage** and identify gaps in testing
   - **Check for common programming errors** and anti-patterns
   - **Validate against requirements** from Steps 1 and 2
   - **Assess code quality** and adherence to best practices

2. **Bug Identification**: Systematically identify potential issues:
   - **Logic errors** in business logic and algorithms
   - **Integration problems** between components
   - **Error handling gaps** and edge cases
   - **Performance bottlenecks** and optimization opportunities
   - **Security vulnerabilities** and input validation issues
   - **Compatibility problems** with specified technologies

3. **Test Analysis**: Evaluate the testing implementation:
   - **Review unit test coverage** for all critical functions
   - **Analyze integration tests** for component interactions
   - **Check test data** and mock implementations
   - **Validate test assertions** and expected outcomes
   - **Identify missing test scenarios** and edge cases

4. **Fix Implementation**: Implement comprehensive fixes:
   - **Correct identified bugs** with clear explanations
   - **Add missing error handling** and validation
   - **Improve test coverage** for uncovered scenarios
   - **Optimize performance** where bottlenecks exist
   - **Enhance security** with proper input validation
   - **Fix integration issues** between components

5. **Validation and Testing**: Ensure fixes are effective:
   - **Run comprehensive tests** to validate fixes
   - **Verify functionality** against original requirements
   - **Test edge cases** and error conditions
   - **Validate performance improvements** with benchmarks
   - **Confirm security enhancements** with vulnerability testing

6. **Documentation Update**: Update documentation to reflect changes:
   - **Update README files** with any new setup requirements
   - **Modify API documentation** if interfaces changed
   - **Update deployment guides** if configuration changed
   - **Add troubleshooting notes** for common issues
   - **Document any breaking changes** or migration steps

## Context Engineering Approach

As an expert in Context Engineering, you will:
- **Leverage comprehensive context** from all previous steps to ensure complete analysis
- **Maintain consistency** with all specifications and requirements
- **Implement systematic fixes** that address root causes, not just symptoms
- **Validate all changes** against the original project scope and technical plan
- **Ensure the final application** meets all quality and functionality requirements

## Analysis Guidelines

### Code Quality Assessment
- **Review code structure** and organization
- **Check naming conventions** and consistency
- **Analyze complexity** and maintainability
- **Validate design patterns** and architecture
- **Assess documentation** quality and completeness

### Security Analysis
- **Input validation** and sanitization
- **Authentication and authorization** implementation
- **Data encryption** and secure transmission
- **Error handling** that doesn't expose sensitive information
- **Dependency vulnerabilities** and outdated packages

### Performance Analysis
- **Algorithm efficiency** and time complexity
- **Database query optimization** and indexing
- **Memory usage** and resource management
- **Caching strategies** and implementation
- **Load handling** and scalability considerations

### Integration Testing
- **Component interaction** and data flow
- **API endpoint** functionality and error handling
- **Database operations** and transaction management
- **External service integration** and error recovery
- **User interface** functionality and user experience

## Output Format

Please provide your analysis and fixes in the following structured format:

### 1. Code Analysis Summary
[Overview of the codebase analysis and identified issues]

### 2. Bug Report
[Detailed list of identified bugs, issues, and areas for improvement]

### 3. Test Analysis
[Evaluation of test coverage and identification of gaps]

### 4. Fixes Implemented
[Detailed description of all fixes and improvements made]

### 5. Updated Codebase
[Complete updated codebase with all fixes applied]

### 6. Test Results
[Comprehensive test results demonstrating fix validation]

### 7. Quality Assurance Report
[Summary of quality improvements and validation results]

### 8. Updated Documentation
[Updated documentation reflecting all changes]

## Self-Correction Mechanisms

### Automated Validation
- **Run all tests** automatically after each fix
- **Validate against requirements** from previous steps
- **Check for regression** in previously working functionality
- **Verify performance** improvements with benchmarks
- **Confirm security** enhancements with vulnerability scans

### Iterative Improvement
- **Implement fixes incrementally** to isolate changes
- **Test each fix individually** before proceeding
- **Validate cumulative changes** after each iteration
- **Document all changes** for future reference
- **Maintain rollback capability** for any problematic changes

### Quality Gates
- **Code coverage** must meet minimum thresholds
- **All tests must pass** before considering fixes complete
- **Performance benchmarks** must show improvement or no regression
- **Security scans** must pass without critical vulnerabilities
- **Documentation must be updated** to reflect all changes

## Ready to Begin

Please start by analyzing the provided codebase and tests, then proceed to identify and fix any issues. I'm ready to review the analysis and provide feedback on any aspects that need clarification or adjustment.

---

**Note**: This prompt is designed to work with the Context Engineering workflow. This step ensures the final application is robust, secure, and fully functional by implementing comprehensive self-correction mechanisms.
